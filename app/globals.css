@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light;
  --color-surface: #f8fafc;
  --color-surface-alt: #ffffff;
  --color-text: #111827;
  --color-muted: #4b5563;
  --color-border: #d1d5db;
  --color-primary: #1d4ed8;
  --color-on-primary: #ffffff;
  --color-secondary: #0f766e;
  --color-accent1: #f59e0b;
  --color-accent2: #b91c1c;
  --color-accent3: #0f172a;
  --color-error: #b91c1c;
  --color-focus: #1d4ed8;
  --color-primary-soft: #e6ecff;
  --color-focus-soft: #dbe8ff;
  --focus-offset: 5rem;
  --tap-min: 24px;

  /* legacy tokens */
  --bg-base: var(--color-surface);
  --card-bg: var(--color-surface-alt);
  --text-dark: var(--color-text);
  --text-light: var(--color-on-primary);
  --primary: var(--color-primary);
  --secondary: var(--color-secondary);
  --accent-1: var(--color-accent1);
  --accent-2: var(--color-accent2);
  --accent-3: var(--color-accent3);
}

@layer base {
  html {
    font-size: 100%;
    line-height: 1.65;
  }

  body {
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", "Meiryo", sans-serif;
    background-color: var(--color-surface);
    color: var(--color-text);
    min-height: 100vh;
  }

  h1 {
    font-size: clamp(1.75rem, 2vw + 1rem, 2.5rem);
    font-weight: 700;
    line-height: 1.25;
  }

  h2 {
    font-size: clamp(1.5rem, 1.5vw + 1rem, 2rem);
    font-weight: 600;
    line-height: 1.3;
  }

  h3,
  h4,
  h5,
  h6 {
    font-weight: 600;
    line-height: 1.35;
  }

  a {
    color: var(--color-primary);
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 4px;
  }

  :focus-visible,
  [data-focus-visible-added] {
    outline: 3px solid var(--color-focus);
    outline-offset: 3px;
  }

  :focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
  }

  :where(h1, h2, h3, h4, h5, h6, [id]) {
    scroll-margin-top: var(--focus-offset);
  }
}

@layer components {
  .container-p {
    @apply mx-auto max-w-5xl px-6;
  }

  .card {
    background-color: var(--color-surface-alt);
    border: 1px solid var(--color-border);
    border-radius: 1.25rem;
    box-shadow: 0 12px 32px rgba(15, 23, 42, 0.08);
    padding: clamp(1.75rem, 1.5vw + 1rem, 2.5rem);
    text-align: left;
  }

  .btn-primary {
    background-color: var(--color-primary);
    color: var(--color-on-primary);
    border-radius: 0.75rem;
    padding: 0.75rem 1.25rem;
    font-weight: 600;
  }

  .work-buttons {
    @apply flex max-h-[calc(100vh-250px)] flex-col gap-3 overflow-y-auto pr-[5px];
  }

  .work-btn {
    background-color: var(--color-primary);
    border-radius: 0.75rem;
    box-shadow: 0 4px 12px rgba(29, 78, 216, 0.2);
    color: var(--color-on-primary);
    font-weight: 700;
    min-height: var(--tap-min);
    padding: 1rem;
  }

  .work-btn:disabled {
    background-image: repeating-linear-gradient(-45deg, rgba(17, 24, 39, 0.25), rgba(17, 24, 39, 0.25) 4px, transparent 4px, transparent 8px);
    color: rgba(255, 255, 255, 0.85);
    cursor: not-allowed;
  }

  .retry-btn {
    background-color: var(--color-accent1);
    border-radius: 0.75rem;
    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.25);
    color: var(--color-text);
    font-weight: 700;
    min-height: var(--tap-min);
    padding: 1rem;
  }

  .loader {
    border: 5px solid rgba(29, 78, 216, 0.25);
    border-radius: 9999px;
    border-top: 5px solid var(--color-primary);
    height: 50px;
    margin: 1.5rem auto;
    width: 50px;
    animation: spin 1s linear infinite;
  }

  .icon {
    display: block;
    height: 72px;
    margin: 0 auto 1rem;
    stroke-width: 2px;
    width: 72px;
  }

  .tap-target {
    min-height: var(--tap-min);
    min-width: var(--tap-min);
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
}

/* ==== Print (A4 portrait) utilities for reports ==== */
@media print {
  /* A4縦・等倍。ブラウザごとに最小余白になるよう指定 */
  @page {
    size: A4 portrait;
    margin: 12mm;
  }

  /* 画面専用部品を非表示（ナビ・ボタン等） */
  .no-print,
  button.no-print,
  .print-hide {
    display: none !important;
  }

  /* 印刷領域を全幅に、背景は白 */
  .print-area {
    background: #fff !important;
    box-shadow: none !important;
  }

  /* 表の折返し改善 */
  table {
    border-collapse: collapse !important;
    page-break-inside: auto;
  }

  thead {
    display: table-header-group;
  }

  tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  /* 見出しの改ページ制御 */
  h1,
  h2,
  h3 {
    page-break-after: avoid;
  }
}

/* 明示的に改ページしたい場所に適用 */
.page-break {
  break-before: page;
}
